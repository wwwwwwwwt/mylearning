<!--
 * @Author: zzzzztw
 * @Date: 2023-03-01 22:20:49
 * @LastEditors: Do not edit
 * @LastEditTime: 2023-03-01 22:54:07
 * @FilePath: /cpptest/mysql45/01基础架构.md
-->
# 一条SQL查询语句是如何执行的
1. 基础架构  
![](./img/01(1).png)
  

2.   流程  
查询缓存这个模块在mysql8.0版本以后被完全删除，不做学习了。  

    2.1 首先要先连接到这个数据库上，连接器会查询你的账户密码和可以操作表的权限再放你进去（此时一个用户成功建立连接后，管理员进行权限修改也不会影响已经存在链接的权限，知道新连接进来），太长时间没动静会断开连接默认8小时，长连接太久会出现内存占用太大，2种方法解决：1重连 2 mysql_rest_connect清空内存，但不用进行重新连接和权限验证。    

    2.2 分析器，对你输入的操作语句进行词法分析（关键词都对不对），语法分析（符不符合mysql语法），语义分析（查询的东西存在吗，比如查询不存在的列）  

    2.3 优化器，对sql语句进行执行方案的选择，先执行啥后执行啥  

    2.4 执行器，判断你有没有操作这张表的权限，有的话执行器根据表的引擎定义使用接口，对表进行处理扫描
3. 课后问题：
如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。 你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？  
答：分析器阶段，分析器进行判断语句是否正确时会查看表是否存在，列是否存在等。